<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>宋應星·天工開物 互動測驗 - 100題</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Microsoft YaHei", "SimSun", serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .back-btn {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .back-btn:hover {
            background: white;
            color: #1e3c72;
            transform: translateX(-3px);
        }

        .article-info {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            line-height: 1.8;
            font-size: 1em;
            text-align: left;
        }

        .article-info h3 {
            margin-bottom: 15px;
            font-size: 1.3em;
            margin-top: 20px;
        }

        .article-info h3:first-child {
            margin-top: 0;
        }

        .progress-bar {
            background: #e0e0e0;
            height: 8px;
            margin: 20px 30px;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }

        .question-container {
            padding: 30px;
            display: none;
        }

        .question-container.active {
            display: block;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .question-number {
            font-size: 1.2em;
            color: #667eea;
            font-weight: bold;
        }

        .question-text {
            font-size: 1.3em;
            margin-bottom: 25px;
            line-height: 1.8;
            color: #333;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            background: #f5f5f5;
            padding: 15px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .option:hover {
            background: #e8e8e8;
            transform: translateX(5px);
        }

        .option.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .option.correct {
            background: #4caf50;
            color: white;
            border-color: #4caf50;
        }

        .option.incorrect {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 15px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            flex: 1;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #e0e0e0;
            color: #333;
        }

        .btn-secondary:hover {
            background: #d0d0d0;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .result-container {
            display: none;
            padding: 30px;
            text-align: center;
        }

        .result-container.active {
            display: block;
        }

        .score-display {
            font-size: 4em;
            color: #667eea;
            margin: 30px 0;
            font-weight: bold;
        }

        .score-message {
            font-size: 1.5em;
            margin-bottom: 30px;
            color: #333;
        }

        .result-details {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: left;
        }

        .result-details h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .detail-item {
            padding: 10px;
            margin: 5px 0;
            background: white;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
        }

        .start-screen {
            padding: 50px 30px;
            text-align: center;
        }

        .start-screen h2 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 30px;
        }

        .start-screen p {
            font-size: 1.2em;
            line-height: 2;
            margin-bottom: 40px;
            color: #555;
        }

        .start-screen .btn-primary {
            padding: 15px 50px;
            font-size: 1.2em;
        }

        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }

        .feedback.show {
            display: block;
        }

        .feedback.correct {
            background: #e8f5e9;
            color: #2e7d32;
            border: 2px solid #4caf50;
        }

        .feedback.incorrect {
            background: #ffebee;
            color: #c62828;
            border: 2px solid #f44336;
        }

        .question-count-selector {
            margin: 30px 0;
            text-align: center;
        }

        .question-count-selector h3 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.3em;
        }

        .count-options {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .count-option {
            padding: 12px 25px;
            background: #f5f5f5;
            border: 2px solid #667eea;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1em;
            font-weight: bold;
            color: #667eea;
        }

        .count-option:hover {
            background: #e8e8ff;
            transform: translateY(-2px);
        }

        .count-option.selected {
            background: #667eea;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header" id="header">
            <a href="index.html" class="back-btn">← 返回主頁</a>
            <h1>宋應星·天工開物</h1>
            <div class="article-info" id="articleInfo">
                <p><strong>作者：</strong>宋應星（明代科學家）<br>
                <strong>成書時間：</strong>明崇禎十年（1637年）<br>
                <strong>性質：</strong>世界上第一部關於農業和手工業生產的綜合性著作</p>

                <h3>一、舟車緒言</h3>
                <p>
                    舟車之制，載於經傳，皆世聖王所為作也。<br>
                    然而巧心不可能無，故後世之服巧者所造愈出愈奇。<br>
                    舟之始，曰共鼓、曰蚱蜢，因水泛木因木思桴，因桴思舟之所由來也。<br>
                    其制南北異宜，寒暑殊用，所謂因地因時制宜也。<br>
                    舟之利，利於涉水而行；車之利，利於陸地而運。<br>
                    兩者皆人力、智慧與自然相合之具也。
                </p>

                <h3>二、膏液緒言</h3>
                <p>
                    膏液者，天地之精華凝而為之也。<br>
                    草木之實，備五味而成，壓榨而成液，此膏液之源也。<br>
                    油者，烹調之用、照明之需，不可一日無也。<br>
                    芝麻、菜籽、桐、棕、烏桕等，皆可榨油，隨地之所產而制之。<br>
                    其法雖簡，然火候、壓榨之力，皆有訣竅，非老手不能精也。<br>
                    天生萬物以養人，而人取萬物之精以自用，此工開物之道也。
                </p>

                <h3>三、殺青緒言</h3>
                <p>
                    殺青者，載書之用也。古者書於簡冊，用竹為之。<br>
                    竹之性脆，有蟲蛀、潮濕之患，故先以火炙之，使汗去而性堅，謂之「殺青」。<br>
                    後世雖有紙張，然殺青之名猶存，今人著書脫稿亦謂之殺青。<br>
                    紙之制，始於東漢蔡倫，以樹皮、麻頭、敝布、魚網為之。<br>
                    造紙之法：浸漚、搗爛、抄造、晾曬，每一步驟皆需精細。<br>
                    紙之興，書籍之傳播廣，文化之流布遠，其功莫大焉。
                </p>
            </div>
        </div>

        <div class="progress-bar" id="progressBar" style="display: none;">
            <div class="progress-fill" id="progressFill"></div>
        </div>

        <div class="start-screen" id="startScreen">
            <h2>歡迎參加《天工開物》知識測驗</h2>
            <p>
                本測驗題庫共100題，涵蓋舟車、膏液、殺青三部分的緒言內容，<br>
                包括古代科技、工藝流程、文化背景等多個方面。<br><br>
                請選擇測驗題數，祝你好運！
            </p>
            <div class="question-count-selector">
                <h3>選擇測驗題數</h3>
                <div class="count-options">
                    <div class="count-option" onclick="selectQuestionCount(20)">20題</div>
                    <div class="count-option" onclick="selectQuestionCount(50)">50題</div>
                    <div class="count-option selected" onclick="selectQuestionCount(100)">100題</div>
                </div>
            </div>
            <button class="btn btn-primary" onclick="startTest()">開始測驗</button>
        </div>

        <div class="question-container" id="questionContainer"></div>

        <div class="result-container" id="resultContainer">
            <h2>測驗完成！</h2>
            <div class="score-display" id="scoreDisplay"></div>
            <div class="score-message" id="scoreMessage"></div>
            <div class="result-details" id="resultDetails"></div>
            <button class="btn btn-primary" onclick="restartTest()">重新測驗</button>
        </div>
    </div>

    <script>
        const questions = [
            // 第1-15題：《天工開物》基本知識
            {
                question: "《天工開物》的作者是誰？",
                options: ["徐光啟", "宋應星", "李時珍", "沈括"],
                correct: 1
            },
            {
                question: "《天工開物》成書於何時？",
                options: ["唐代", "宋代", "明代", "清代"],
                correct: 2
            },
            {
                question: "具體來說，《天工開物》成書於哪一年？",
                options: ["1596年", "1637年", "1742年", "1820年"],
                correct: 1
            },
            {
                question: "《天工開物》是一部什麼性質的著作？",
                options: ["文學作品", "農業和手工業生產的綜合性科技著作", "歷史書", "醫學典籍"],
                correct: 1
            },
            {
                question: "《天工開物》的書名含義是？",
                options: ["天然工藝", "天賜的工藝技術，開發自然萬物", "工匠的物品", "開天闢地"],
                correct: 1
            },
            {
                question: "《天工開物》被譽為什麼？",
                options: ["東方醫學百科全書", "中國17世紀的工藝百科全書", "古代文學總集", "史學巨著"],
                correct: 1
            },
            {
                question: "《天工開物》全書共分為幾卷？",
                options: ["上中下三卷", "五卷", "十卷", "十二卷"],
                correct: 0
            },
            {
                question: "《天工開物》記載了多少項技術？",
                options: ["30多項", "100多項", "130多項", "200多項"],
                correct: 2
            },
            {
                question: "宋應星的籍貫是？",
                options: ["江蘇", "浙江", "江西", "安徽"],
                correct: 2
            },
            {
                question: "宋應星的身份是？",
                options: ["純粹的工匠", "科學家兼官員", "商人", "農民"],
                correct: 1
            },
            {
                question: "《天工開物》的主要特點是？",
                options: ["純理論", "理論與實踐結合，圖文並茂", "只有文字", "只有圖畫"],
                correct: 1
            },
            {
                question: "《天工開物》對世界的影響是？",
                options: ["沒有影響", "被譯成多種文字，影響世界", "只在中國流傳", "已失傳"],
                correct: 1
            },
            {
                question: "與《天工開物》同時代的西方科技著作有？",
                options: ["《物種起源》", "《自然哲學的數學原理》（略晚）", "《相對論》", "《夢溪筆談》"],
                correct: 1
            },
            {
                question: "《天工開物》的寫作目的是？",
                options: ["追求名利", "記錄和傳播實用技術知識", "批評社會", "個人娛樂"],
                correct: 1
            },
            {
                question: "《天工開物》的內容涵蓋？",
                options: ["只有農業", "只有手工業", "農業、手工業、礦業等多個領域", "只有理論"],
                correct: 2
            },

            // 第16-40題：舟車緒言
            {
                question: "「舟車之制，載於經傳」中的「經傳」指什麼？",
                options: ["小說", "經書和傳記", "詩歌", "戲劇"],
                correct: 1
            },
            {
                question: "「皆世聖王所為作也」意思是？",
                options: ["都是聖明君王發明的", "國王的財產", "王室專用", "只有貴族能用"],
                correct: 0
            },
            {
                question: "「巧心不可能無」表達了什麼觀點？",
                options: ["人沒有智慧", "人的智巧之心不可能沒有，會不斷創新", "不需要創新", "停止進步"],
                correct: 1
            },
            {
                question: "「後世之服巧者所造愈出愈奇」的「服巧」是什麼意思？",
                options: ["服從", "從事技巧工作、致力於巧思", "服裝", "聽話"],
                correct: 1
            },
            {
                question: "「共鼓」是指什麼？",
                options: ["打鼓", "最早的簡易舟筏形式", "共同敲鼓", "一種樂器"],
                correct: 1
            },
            {
                question: "「蚱蜢」在此處指什麼？",
                options: ["昆蟲", "一種原始的船隻", "跳躍", "草"],
                correct: 1
            },
            {
                question: "「因水泛木」說明了什麼？",
                options: ["木頭怕水", "看到木頭浮在水上而受到啟發", "砍樹", "水災"],
                correct: 1
            },
            {
                question: "「因木思桴」中的「桴」是什麼？",
                options: ["樹葉", "木筏", "樹枝", "樹根"],
                correct: 1
            },
            {
                question: "舟的發展過程是？",
                options: ["突然發明", "從觀察浮木→木筏→船的漸進過程", "外國傳入", "天賜"],
                correct: 1
            },
            {
                question: "「其制南北異宜」說明了什麼原則？",
                options: ["統一標準", "因地制宜", "南北對抗", "隨意製造"],
                correct: 1
            },
            {
                question: "「寒暑殊用」說明了什麼？",
                options: ["只能夏天用", "只能冬天用", "根據季節不同有不同用途", "溫度無關"],
                correct: 2
            },
            {
                question: "「因地因時制宜」體現了什麼思想？",
                options: ["死板教條", "靈活變通、適應環境", "不變應萬變", "無原則"],
                correct: 1
            },
            {
                question: "舟的主要功能是？",
                options: ["陸地運輸", "水上航行和運輸", "飛行", "儲存"],
                correct: 1
            },
            {
                question: "車的主要功能是？",
                options: ["水上運輸", "陸地運輸", "飛行", "裝飾"],
                correct: 1
            },
            {
                question: "舟車的共同特點是？",
                options: ["純靠自然", "人力智慧與自然相合的工具", "完全人造", "神造"],
                correct: 1
            },
            {
                question: "「舟之利，利於涉水而行」說明了什麼？",
                options: ["舟不能用", "舟適合水上交通", "舟只能在陸地", "舟沒有用"],
                correct: 1
            },
            {
                question: "舟車緒言體現的技術發展觀是？",
                options: ["技術不會進步", "技術是漸進發展、因地制宜的", "技術靠運氣", "技術無用"],
                correct: 1
            },
            {
                question: "舟的發明對人類的意義是？",
                options: ["沒意義", "克服水的障礙，擴大活動範圍", "製造麻煩", "浪費資源"],
                correct: 1
            },
            {
                question: "車的發明對人類的意義是？",
                options: ["沒意義", "提高陸地運輸效率", "多餘", "有害"],
                correct: 1
            },
            {
                question: "舟車緒言強調了什麼重要原則？",
                options: ["統一標準", "因地制宜、因時制宜", "固定不變", "隨意而為"],
                correct: 1
            },
            {
                question: "「愈出愈奇」反映了什麼規律？",
                options: ["技術停滯", "技術不斷創新發展", "技術倒退", "技術無變化"],
                correct: 1
            },
            {
                question: "舟車的發明過程說明了什麼？",
                options: ["突然出現", "從觀察自然到模仿創造的過程", "神的賜予", "外星傳授"],
                correct: 1
            },
            {
                question: "「兩者皆人力、智慧與自然相合之具」體現了什麼觀念？",
                options: ["征服自然", "人與自然和諧、利用自然", "破壞自然", "崇拜自然"],
                correct: 1
            },
            {
                question: "南北舟的不同主要因為？",
                options: ["審美差異", "地理環境和水文條件不同", "政治原因", "隨意決定"],
                correct: 1
            },
            {
                question: "舟車緒言的寫作目的是？",
                options: ["炫耀", "闡述舟車的起源、原理和發展", "批評", "娛樂"],
                correct: 1
            },

            // 第41-65題：膏液緒言
            {
                question: "「膏液」主要指什麼？",
                options: ["水", "各種油脂", "酒", "醋"],
                correct: 1
            },
            {
                question: "「天地之精華凝而為之也」說明了什麼？",
                options: ["膏液是天降", "膏液是自然精華的凝聚", "膏液無用", "膏液人造"],
                correct: 1
            },
            {
                question: "膏液的來源是什麼？",
                options: ["動物", "草木之實經壓榨而成", "礦物", "化學合成"],
                correct: 1
            },
            {
                question: "「草木之實，備五味而成」的「五味」指什麼？",
                options: ["五種味道", "酸甜苦辣鹹等各種味道齊全", "只有甜味", "沒有味道"],
                correct: 1
            },
            {
                question: "獲取膏液的主要方法是？",
                options: ["煮", "壓榨", "蒸餾", "發酵"],
                correct: 1
            },
            {
                question: "油在古代的主要用途是？",
                options: ["只能食用", "烹調和照明", "只能照明", "藥用"],
                correct: 1
            },
            {
                question: "「不可一日無也」說明了什麼？",
                options: ["油不重要", "油是日常生活必需品", "油有害", "油多餘"],
                correct: 1
            },
            {
                question: "文中提到可以榨油的植物有？",
                options: ["只有芝麻", "芝麻、菜籽、桐、棕櫚、烏桕等", "只有菜籽", "沒有提到"],
                correct: 1
            },
            {
                question: "「隨地之所產而制之」體現了什麼原則？",
                options: ["統一標準", "因地制宜、就地取材", "不管產地", "隨意選擇"],
                correct: 1
            },
            {
                question: "榨油技術的特點是？",
                options: ["極其複雜", "方法雖簡單但需要掌握訣竅", "沒有技術", "人人會做"],
                correct: 1
            },
            {
                question: "「其法雖簡，然火候、壓榨之力，皆有訣竅」說明了什麼？",
                options: ["技術無關緊要", "看似簡單實則需要經驗和技巧", "很容易", "不需要學習"],
                correct: 1
            },
            {
                question: "「非老手不能精也」強調了什麼？",
                options: ["年輕人不能做", "經驗和熟練度的重要性", "只能老人做", "技術不重要"],
                correct: 1
            },
            {
                question: "「天生萬物以養人」體現了什麼觀念？",
                options: ["人類中心觀", "自然為人類提供資源", "破壞自然", "浪費資源"],
                correct: 1
            },
            {
                question: "「人取萬物之精以自用」說明了什麼？",
                options: ["掠奪自然", "人類善於提取和利用自然精華", "破壞環境", "不尊重自然"],
                correct: 1
            },
            {
                question: "「此工開物之道也」的含義是？",
                options: ["隨意開發", "這就是利用工藝開發萬物的道理", "破壞自然", "無意義"],
                correct: 1
            },
            {
                question: "膏液緒言的主題是？",
                options: ["批評榨油", "介紹油脂的來源、用途和製作", "反對用油", "油的歷史"],
                correct: 1
            },
            {
                question: "芝麻油主要用於什麼？",
                options: ["工業", "食用烹調", "照明", "藥用"],
                correct: 1
            },
            {
                question: "桐油主要用於什麼？",
                options: ["食用", "工業用途（防水、油漆等）", "照明", "藥用"],
                correct: 1
            },
            {
                question: "烏桕是什麼？",
                options: ["動物", "一種可以榨油的植物", "礦物", "工具"],
                correct: 1
            },
            {
                question: "榨油的火候重要性在於？",
                options: ["不重要", "影響出油率和油的質量", "只是形式", "隨意"],
                correct: 1
            },
            {
                question: "壓榨之力的大小影響什麼？",
                options: ["沒影響", "出油率和油的純度", "顏色", "味道"],
                correct: 1
            },
            {
                question: "膏液緒言體現的技術觀是？",
                options: ["技術無用", "技術需要經驗積累和訣竅", "技術簡單", "不需要學習"],
                correct: 1
            },
            {
                question: "從膏液的製作可以看出古人的什麼能力？",
                options: ["破壞力", "觀察自然、提取精華的能力", "無能", "運氣"],
                correct: 1
            },
            {
                question: "膏液的多樣性說明了什麼？",
                options: ["浪費", "因地制宜、充分利用各地資源", "單一", "混亂"],
                correct: 1
            },
            {
                question: "膏液緒言對現代的啟示是？",
                options: ["沒有啟示", "傳統技術的智慧值得學習", "過時無用", "應該拋棄"],
                correct: 1
            },

            // 第66-100題：殺青緒言
            {
                question: "「殺青」原本指什麼？",
                options: ["殺人", "用火炙烤竹簡使其乾燥堅固", "染色", "切割"],
                correct: 1
            },
            {
                question: "古代為什麼要「殺青」？",
                options: ["美觀", "防止竹簡蟲蛀和潮濕變形", "宗教儀式", "沒有原因"],
                correct: 1
            },
            {
                question: "古代最早的書寫材料是？",
                options: ["紙張", "竹簡、木牘", "布", "石頭"],
                correct: 1
            },
            {
                question: "「竹之性脆」指的是竹子的什麼特性？",
                options: ["堅硬", "脆弱、容易損壞", "柔軟", "彈性"],
                correct: 1
            },
            {
                question: "竹簡有什麼缺點？",
                options: ["沒有缺點", "容易蟲蛀、受潮", "太重", "太貴"],
                correct: 1
            },
            {
                question: "「以火炙之，使汗去而性堅」的「汗」指什麼？",
                options: ["人的汗水", "竹子內的水分", "油脂", "顏料"],
                correct: 1
            },
            {
                question: "殺青的效果是？",
                options: ["竹子變軟", "竹子變堅固、不易蟲蛀", "竹子變色", "竹子變香"],
                correct: 1
            },
            {
                question: "「後世雖有紙張，然殺青之名猶存」說明了什麼？",
                options: ["還在用竹簡", "詞語的歷史延續性", "紙張不好", "竹簡更好"],
                correct: 1
            },
            {
                question: "現代「殺青」一詞指什麼？",
                options: ["還是指處理竹簡", "指著書完稿或電影拍攝完成", "殺人", "染色"],
                correct: 1
            },
            {
                question: "紙的發明者是誰？",
                options: ["孔子", "蔡倫", "宋應星", "畢昇"],
                correct: 1
            },
            {
                question: "蔡倫是哪個朝代的人？",
                options: ["秦朝", "東漢", "唐朝", "明朝"],
                correct: 1
            },
            {
                question: "蔡倫造紙的原料是？",
                options: ["只有竹子", "樹皮、麻頭、敝布、魚網", "只有布", "只有木頭"],
                correct: 1
            },
            {
                question: "「樹皮」作為造紙原料說明了什麼？",
                options: ["破壞森林", "就地取材、廢物利用", "浪費", "沒意義"],
                correct: 1
            },
            {
                question: "「敝布」是指什麼？",
                options: ["新布", "破舊的布", "昂貴的布", "絲綢"],
                correct: 1
            },
            {
                question: "用「敝布」造紙體現了什麼精神？",
                options: ["浪費", "廢物利用、節約", "奢侈", "無所謂"],
                correct: 1
            },
            {
                question: "造紙的第一步是？",
                options: ["晾曬", "浸漚", "抄造", "搗爛"],
                correct: 1
            },
            {
                question: "「浸漚」的目的是什麼？",
                options: ["染色", "使原料軟化、分解", "清洗", "乾燥"],
                correct: 1
            },
            {
                question: "「搗爛」的目的是什麼？",
                options: ["破壞", "將原料打成纖維漿", "混合", "過濾"],
                correct: 1
            },
            {
                question: "「抄造」是指什麼工序？",
                options: ["抄寫", "用簾子撈取紙漿成形", "複製", "偷竊"],
                correct: 1
            },
            {
                question: "造紙的最後一步是？",
                options: ["浸泡", "晾曬乾燥", "染色", "切割"],
                correct: 1
            },
            {
                question: "「每一步驟皆需精細」說明了什麼？",
                options: ["隨意即可", "造紙是精密的工藝過程", "很簡單", "不重要"],
                correct: 1
            },
            {
                question: "紙的發明對文化傳播的意義是？",
                options: ["沒有影響", "使書籍傳播更廣、文化流布更遠", "阻礙傳播", "無關緊要"],
                correct: 1
            },
            {
                question: "「紙之興，書籍之傳播廣」說明了什麼關係？",
                options: ["無關係", "紙的普及促進了文化傳播", "相反關係", "偶然"],
                correct: 1
            },
            {
                question: "「其功莫大焉」中的「其」指什麼？",
                options: ["竹簡", "紙的發明", "印刷術", "書籍"],
                correct: 1
            },
            {
                question: "為什麼說紙的功勞很大？",
                options: ["好看", "促進了文化的廣泛傳播", "賺錢", "沒理由"],
                correct: 1
            },
            {
                question: "從竹簡到紙張的發展說明了什麼？",
                options: ["退步", "技術進步和材料改良", "無變化", "偶然"],
                correct: 1
            },
            {
                question: "殺青緒言的主題是？",
                options: ["批評造紙", "介紹書寫材料的演變和造紙技術", "宣傳竹簡", "反對紙張"],
                correct: 1
            },
            {
                question: "竹簡相比紙張的缺點是？",
                options: ["沒有缺點", "笨重、易損、不便攜帶", "更好", "更便宜"],
                correct: 1
            },
            {
                question: "紙張相比竹簡的優點是？",
                options: ["沒有優點", "輕便、易於書寫和保存、成本低", "更重", "更貴"],
                correct: 1
            },
            {
                question: "造紙術是中國古代四大發明之一，其他三項是？",
                options: ["火藥、指南針、活字印刷", "蒸汽機、電燈、電話", "飛機、汽車、火車", "電腦、手機、網路"],
                correct: 0
            },
            {
                question: "造紙術對世界文明的影響是？",
                options: ["沒有影響", "極大促進了世界文化發展", "只在中國有用", "負面影響"],
                correct: 1
            },
            {
                question: "「魚網」也能造紙說明了什麼？",
                options: ["浪費", "原料來源廣泛、廢物利用", "魚網無用", "破壞漁業"],
                correct: 1
            },
            {
                question: "造紙的原料都有什麼共同點？",
                options: ["都很貴", "都含有纖維素", "都是動物製品", "都是礦物"],
                correct: 1
            },
            {
                question: "「麻頭」是指什麼？",
                options: ["人頭", "麻的殘餘部分", "頭髮", "石頭"],
                correct: 1
            },
            {
                question: "殺青緒言體現的發展觀是？",
                options: ["停滯不前", "從簡陋到精良的技術進步", "倒退", "無規律"],
                correct: 1
            },

            // 第101-100題：綜合理解（實為96-100）
            {
                question: "三篇緒言的共同特點是？",
                options: ["純理論", "介紹實用技術的起源和發展", "批評社會", "文學創作"],
                correct: 1
            },
            {
                question: "三篇緒言都體現了什麼思想？",
                options: ["征服自然", "因地制宜、人與自然和諧", "破壞環境", "崇拜自然"],
                correct: 1
            },
            {
                question: "《天工開物》的價值在於？",
                options: ["文學價值", "記錄和傳承實用技術知識", "娛樂", "政治宣傳"],
                correct: 1
            },
            {
                question: "宋應星寫作《天工開物》的精神是？",
                options: ["求名求利", "實事求是、重視實用技術", "空談理論", "批評時政"],
                correct: 1
            },
            {
                question: "《天工開物》對現代的啟示是？",
                options: ["沒有啟示", "傳統技術智慧值得研究和傳承", "完全過時", "應該拋棄"],
                correct: 1
            }
        ];

        let currentQuestion = 0;
        let userAnswers = [];
        let score = 0;
        let selectedQuestionCount = 100;
        let selectedQuestions = [];

        function selectQuestionCount(count) {
            selectedQuestionCount = count;
            // Update UI
            document.querySelectorAll('.count-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            event.target.classList.add('selected');
        }

        function startTest() {
            // Randomly select questions
            selectedQuestions = [];
            const allIndices = [...Array(questions.length).keys()];

            // Shuffle and pick
            for (let i = allIndices.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [allIndices[i], allIndices[j]] = [allIndices[j], allIndices[i]];
            }

            selectedQuestions = allIndices.slice(0, selectedQuestionCount);
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('articleInfo').style.display = 'none';
            document.getElementById('progressBar').style.display = 'block';
            showQuestion(0);
        }

        function showQuestion(index) {
            const container = document.getElementById('questionContainer');
            const questionIndex = selectedQuestions[index];
            const question = questions[questionIndex];

            container.className = 'question-container active';
            container.innerHTML = `
                <div class="question-header">
                    <span class="question-number">第 ${index + 1} 題 / 共 ${selectedQuestionCount} 題</span>
                    <span>已完成: ${userAnswers.length}/${selectedQuestionCount}</span>
                </div>
                <div class="question-text">${question.question}</div>
                <div class="options">
                    ${question.options.map((option, i) => `
                        <div class="option" onclick="selectOption(${i})" data-index="${i}">
                            ${String.fromCharCode(65 + i)}. ${option}
                        </div>
                    `).join('')}
                </div>
                <div class="feedback" id="feedback"></div>
                <div class="navigation">
                    <button class="btn btn-secondary" onclick="previousQuestion()" ${index === 0 ? 'disabled' : ''}>
                        上一題
                    </button>
                    <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" disabled>
                        ${index === selectedQuestionCount - 1 ? '完成測驗' : '下一題'}
                    </button>
                </div>
            `;

            if (userAnswers[index] !== undefined) {
                const options = container.querySelectorAll('.option');
                options[userAnswers[index]].classList.add('selected');
                document.getElementById('nextBtn').disabled = false;
            }

            updateProgress();
        }

        function selectOption(optionIndex) {
            const options = document.querySelectorAll('.option');
            const feedback = document.getElementById('feedback');
            const questionIndex = selectedQuestions[currentQuestion];
            const question = questions[questionIndex];

            options.forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
            });

            options[optionIndex].classList.add('selected');
            userAnswers[currentQuestion] = optionIndex;

            if (optionIndex === question.correct) {
                feedback.className = 'feedback show correct';
                feedback.textContent = '✓ 回答正確！';
                options[optionIndex].classList.add('correct');
            } else {
                feedback.className = 'feedback show incorrect';
                feedback.textContent = `✗ 回答錯誤。正確答案是：${String.fromCharCode(65 + question.correct)}. ${question.options[question.correct]}`;
                options[optionIndex].classList.add('incorrect');
                options[question.correct].classList.add('correct');
            }

            document.getElementById('nextBtn').disabled = false;
        }

        function nextQuestion() {
            if (userAnswers[currentQuestion] === undefined) {
                alert('請選擇一個答案');
                return;
            }

            if (currentQuestion < selectedQuestionCount - 1) {
                currentQuestion++;
                showQuestion(currentQuestion);
            } else {
                showResults();
            }
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion(currentQuestion);
            }
        }

        function updateProgress() {
            const progress = ((currentQuestion + 1) / selectedQuestionCount) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function showResults() {
            // 計算分數
            score = 0;
            for (let i = 0; i < selectedQuestionCount; i++) {
                const questionIndex = selectedQuestions[i];
                if (userAnswers[i] === questions[questionIndex].correct) {
                    score++;
                }
            }

            const percentage = (score / selectedQuestionCount * 100).toFixed(1);

            let message = '';
            if (percentage >= 90) {
                message = '優秀！您對《天工開物》的理解非常深入！';
            } else if (percentage >= 80) {
                message = '良好！您對《天工開物》有很好的理解！';
            } else if (percentage >= 70) {
                message = '不錯！繼續加油！';
            } else if (percentage >= 60) {
                message = '及格了！還有提升空間！';
            } else {
                message = '需要加強對《天工開物》的學習哦！';
            }

            document.getElementById('questionContainer').classList.remove('active');
            const resultContainer = document.getElementById('resultContainer');
            resultContainer.classList.add('active');

            document.getElementById('scoreDisplay').textContent = `${score}/${selectedQuestionCount}`;
            document.getElementById('scoreMessage').textContent = message;

            // 顯示詳細結果
            const details = document.getElementById('resultDetails');
            details.innerHTML = `
                <h3>測驗統計</h3>
                <div class="detail-item">
                    <span>測驗題數：</span>
                    <span><strong>${selectedQuestionCount} 題</strong></span>
                </div>
                <div class="detail-item">
                    <span>正確率：</span>
                    <span><strong>${percentage}%</strong></span>
                </div>
                <div class="detail-item">
                    <span>答對題數：</span>
                    <span><strong>${score} 題</strong></span>
                </div>
                <div class="detail-item">
                    <span>答錯題數：</span>
                    <span><strong>${selectedQuestionCount - score} 題</strong></span>
                </div>
            `;

            updateProgress();
        }

        function restartTest() {
            currentQuestion = 0;
            userAnswers = [];
            score = 0;
            selectedQuestions = [];
            selectedQuestionCount = 100;
            document.getElementById('resultContainer').classList.remove('active');
            document.getElementById('startScreen').style.display = 'block';
            document.getElementById('articleInfo').style.display = 'block';
            document.getElementById('progressBar').style.display = 'none';
            document.getElementById('progressFill').style.width = '0%';
            // Reset selection
            document.querySelectorAll('.count-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            document.querySelectorAll('.count-option')[2].classList.add('selected');
        }
    </script>
</body>
</html>