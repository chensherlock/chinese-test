<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>左丘明·燭之武退秦師 互動測驗 - 100題</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Microsoft YaHei", "SimSun", serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .back-btn {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .back-btn:hover {
            background: white;
            color: #1e3c72;
            transform: translateX(-3px);
        }

        .article-text {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            line-height: 2;
            font-size: 1.1em;
            text-align: left;
        }

        .progress-bar {
            background: #e0e0e0;
            height: 8px;
            margin: 20px 30px;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }

        .question-container {
            padding: 30px;
            display: none;
        }

        .question-container.active {
            display: block;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .question-number {
            font-size: 1.2em;
            color: #667eea;
            font-weight: bold;
        }

        .question-text {
            font-size: 1.3em;
            margin-bottom: 25px;
            line-height: 1.8;
            color: #333;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            background: #f5f5f5;
            padding: 15px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .option:hover {
            background: #e8e8e8;
            transform: translateX(5px);
        }

        .option.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .option.correct {
            background: #4caf50;
            color: white;
            border-color: #4caf50;
        }

        .option.incorrect {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 15px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            flex: 1;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #e0e0e0;
            color: #333;
        }

        .btn-secondary:hover {
            background: #d0d0d0;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .result-container {
            display: none;
            padding: 30px;
            text-align: center;
        }

        .result-container.active {
            display: block;
        }

        .score-display {
            font-size: 4em;
            color: #667eea;
            margin: 30px 0;
            font-weight: bold;
        }

        .score-message {
            font-size: 1.5em;
            margin-bottom: 30px;
            color: #333;
        }

        .result-details {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: left;
        }

        .result-details h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .detail-item {
            padding: 10px;
            margin: 5px 0;
            background: white;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
        }

        .start-screen {
            padding: 50px 30px;
            text-align: center;
        }

        .start-screen h2 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 30px;
        }

        .start-screen p {
            font-size: 1.2em;
            line-height: 2;
            margin-bottom: 40px;
            color: #555;
        }

        .start-screen .btn-primary {
            padding: 15px 50px;
            font-size: 1.2em;
        }

        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }

        .feedback.show {
            display: block;
        }

        .feedback.correct {
            background: #e8f5e9;
            color: #2e7d32;
            border: 2px solid #4caf50;
        }

        .feedback.incorrect {
            background: #ffebee;
            color: #c62828;
            border: 2px solid #f44336;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header" id="header">
            <a href="index.html" class="back-btn">← 返回主頁</a>
            <h1>左丘明·燭之武退秦師</h1>
            <div class="article-text" id="articleText">
                晉侯、秦伯圍鄭，以其無禮於晉，且貳於楚也。晉軍函陵，秦軍氾南。<br><br>

                佚之狐言於鄭伯曰：「國危矣！若使燭之武見秦君，師必退。」公從之。<br>
                辭曰：「臣之壯也，猶不如人；今老矣，無能為也已。」<br>
                公曰：「吾不能早用子，今急而求子，是寡人之過也。然鄭亡，子亦有不利焉。」許之。<br><br>

                夜，縋而出。見秦伯，曰：<br>
                「秦、晉圍鄭，鄭既知亡矣。若亡鄭而有益於君，敢以煩執事。<br>
                越國以鄙遠，君知其難也。焉用亡鄭以陪鄰？鄰之厚，君之薄也。<br>
                若舍鄭以為東道主，行李之往來，共其乏困，君亦無所害。<br>
                且君嘗為晉君賜矣，許君焦、瑕，朝濟而夕設版焉，君之所知也。<br>
                夫晉何厭之有？既東封鄭，又欲肆其西封。若不闕秦，將焉取之？<br>
                闕秦以利晉，唯君圖之。」<br>
                秦伯說，與鄭人盟。使杞子、逢孫、楊孫戍之，乃還。<br><br>

                子犯請擊之，公曰：「不可。微夫人之力不及此。因人之力而敝之，不仁；<br>
                失其所與，不知；以亂易整，不武。吾其還也。」亦去之。
            </div>
        </div>

        <div class="progress-bar" id="progressBar" style="display: none;">
            <div class="progress-fill" id="progressFill"></div>
        </div>

        <div class="start-screen" id="startScreen">
            <h2>歡迎參加《燭之武退秦師》知識測驗</h2>
            <p>
                本測驗共100題，涵蓋文章內容、文言詞彙、外交辭令、<br>
                歷史背景、人物形象、寫作技巧等多個方面。<br><br>
                點擊開始按鈕開始測驗，祝你好運！
            </p>
            <button class="btn btn-primary" onclick="startTest()">開始測驗</button>
        </div>

        <div class="question-container" id="questionContainer"></div>

        <div class="result-container" id="resultContainer">
            <h2>測驗完成！</h2>
            <div class="score-display" id="scoreDisplay"></div>
            <div class="score-message" id="scoreMessage"></div>
            <div class="result-details" id="resultDetails"></div>
            <button class="btn btn-primary" onclick="restartTest()">重新測驗</button>
        </div>
    </div>

    <script>
        const questions = [
            // 第1-10題：基本字詞
            {
                question: "《燭之武退秦師》選自哪部典籍？",
                options: ["《史記》", "《左傳》", "《戰國策》", "《國語》"],
                correct: 1
            },
            {
                question: "《左傳》的作者相傳是誰？",
                options: ["左丘明", "司馬遷", "班固", "孔子"],
                correct: 0
            },
            {
                question: "「晉侯」指的是誰？",
                options: ["晉文公", "晉獻公", "晉平公", "晉景公"],
                correct: 0
            },
            {
                question: "「秦伯」指的是誰？",
                options: ["秦穆公", "秦孝公", "秦始皇", "秦二世"],
                correct: 0
            },
            {
                question: "「圍鄭」中的「鄭」是指？",
                options: ["鄭國", "鄭州", "鄭人", "鄭地"],
                correct: 0
            },
            {
                question: "「以其無禮於晉」的「以」是什麼意思？",
                options: ["用", "因為", "以為", "憑藉"],
                correct: 1
            },
            {
                question: "「且貳於楚也」的「貳」是什麼意思？",
                options: ["第二", "兩次", "從屬二主、不專一", "背叛"],
                correct: 2
            },
            {
                question: "「函陵」和「氾南」指的是？",
                options: ["城市名", "駐軍地點", "戰場", "山名"],
                correct: 1
            },
            {
                question: "「佚之狐」是什麼人？",
                options: ["鄭國大夫", "秦國使者", "晉國將軍", "楚國謀士"],
                correct: 0
            },
            {
                question: "「師必退」的「師」是什麼意思？",
                options: ["老師", "軍隊", "師傅", "學生"],
                correct: 1
            },

            // 第11-20題：燭之武的對話前
            {
                question: "燭之武最初對出使的態度是？",
                options: ["欣然接受", "推辭", "猶豫不決", "憤怒拒絕"],
                correct: 1
            },
            {
                question: "「臣之壯也，猶不如人」表達了什麼？",
                options: ["自謙", "對懷才不遇的感慨", "自卑", "謙虛"],
                correct: 1
            },
            {
                question: "「今老矣，無能為也已」的「已」是什麼意思？",
                options: ["已經", "停止", "語氣助詞", "完了"],
                correct: 2
            },
            {
                question: "鄭伯如何說服燭之武？",
                options: ["威脅", "承認過錯並曉以利害", "賄賂", "命令"],
                correct: 1
            },
            {
                question: "「吾不能早用子」表達了鄭伯的什麼情感？",
                options: ["憤怒", "後悔、自責", "無所謂", "高興"],
                correct: 1
            },
            {
                question: "「是寡人之過也」的「是」指什麼？",
                options: ["正確", "這", "判斷", "對的"],
                correct: 1
            },
            {
                question: "「然鄭亡，子亦有不利焉」是什麼論證方法？",
                options: ["舉例", "曉以利害", "威脅", "命令"],
                correct: 1
            },
            {
                question: "燭之武最後為什麼答應出使？",
                options: ["貪圖富貴", "國家利益與個人命運相連", "畏懼鄭伯", "無奈"],
                correct: 1
            },
            {
                question: "「許之」的「許」是什麼意思？",
                options: ["允許", "答應、同意", "許諾", "承諾"],
                correct: 1
            },
            {
                question: "「夜，縋而出」的「縋」是什麼意思？",
                options: ["飛出", "用繩子吊著下去", "偷偷出去", "跑出去"],
                correct: 1
            },

            // 第21-30題：燭之武的遊說辭令（一）
            {
                question: "「鄭既知亡矣」採用了什麼策略？",
                options: ["示弱、欲擒故縱", "威脅", "哀求", "諂媚"],
                correct: 0
            },
            {
                question: "「若亡鄭而有益於君」是什麼句式？",
                options: ["陳述句", "假設句", "疑問句", "感嘆句"],
                correct: 1
            },
            {
                question: "「敢以煩執事」表達了什麼態度？",
                options: ["傲慢", "謙恭、禮貌", "輕蔑", "憤怒"],
                correct: 1
            },
            {
                question: "「越國以鄙遠」的「鄙」是什麼意思？",
                options: ["鄙視", "邊境、把...當作邊邑", "卑鄙", "郊外"],
                correct: 1
            },
            {
                question: "「越國以鄙遠，君知其難也」指出了什麼問題？",
                options: ["秦國弱小", "滅鄭對秦國沒有實際利益", "鄭國強大", "晉國威脅"],
                correct: 1
            },
            {
                question: "「焉用亡鄭以陪鄰」的「陪」是什麼意思？",
                options: ["陪伴", "增加、加厚", "賠償", "培養"],
                correct: 1
            },
            {
                question: "「鄰之厚，君之薄也」的「鄰」指誰？",
                options: ["鄭國", "晉國", "楚國", "齊國"],
                correct: 1
            },
            {
                question: "「鄰之厚，君之薄也」運用了什麼手法？",
                options: ["比喻", "對比、利害分析", "誇張", "排比"],
                correct: 1
            },
            {
                question: "這段話的核心論點是什麼？",
                options: ["鄭國很弱", "滅鄭對秦無益反而利晉", "求和", "投降"],
                correct: 1
            },
            {
                question: "燭之武首先分析的是？",
                options: ["秦鄭關係", "秦晉關係", "滅鄭的利弊", "歷史恩怨"],
                correct: 2
            },

            // 第31-40題：燭之武的遊說辭令（二）
            {
                question: "「若舍鄭以為東道主」的「舍」是什麼意思？",
                options: ["房屋", "捨棄", "寬恕、放過", "給予"],
                correct: 2
            },
            {
                question: "「東道主」原指什麼？",
                options: ["東方的主人", "東邊路上招待客人的主人", "房東", "領導"],
                correct: 1
            },
            {
                question: "「行李之往來」的「行李」指什麼？",
                options: ["行李箱", "使者", "商人", "旅客"],
                correct: 1
            },
            {
                question: "「共其乏困」的「共」通什麼字？",
                options: ["公", "供", "恭", "貢"],
                correct: 1
            },
            {
                question: "「君亦無所害」是說明什麼？",
                options: ["秦國會受害", "保留鄭國對秦有利無害", "鄭國無害", "晉國無害"],
                correct: 1
            },
            {
                question: "「且君嘗為晉君賜矣」開始分析什麼關係？",
                options: ["秦鄭關係", "秦晉關係", "晉鄭關係", "三國關係"],
                correct: 1
            },
            {
                question: "「許君焦、瑕」指的是什麼事？",
                options: ["送禮", "晉國曾答應給秦國土地", "結盟", "宣戰"],
                correct: 1
            },
            {
                question: "「朝濟而夕設版焉」的「濟」是什麼意思？",
                options: ["救濟", "渡河", "完成", "成功"],
                correct: 1
            },
            {
                question: "「朝濟而夕設版焉」說明了什麼？",
                options: ["晉國效率高", "晉國背信棄義", "晉國強大", "秦國無能"],
                correct: 1
            },
            {
                question: "這段話的目的是？",
                options: ["讚美晉國", "挑撥秦晉關係", "求和", "威脅"],
                correct: 1
            },

            // 第41-50題：燭之武的遊說辭令（三）
            {
                question: "「夫晉何厭之有」是什麼句式？",
                options: ["陳述句", "疑問句、賓語前置", "感嘆句", "祈使句"],
                correct: 1
            },
            {
                question: "「厭」在此處是什麼意思？",
                options: ["厭煩", "滿足", "討厭", "疲倦"],
                correct: 1
            },
            {
                question: "「既東封鄭，又欲肆其西封」的「封」是什麼意思？",
                options: ["封閉", "封地、疆界", "封賞", "封鎖"],
                correct: 1
            },
            {
                question: "「肆」在此處的意思是？",
                options: ["放肆", "擴張、延展", "四", "店鋪"],
                correct: 1
            },
            {
                question: "「若不闕秦，將焉取之」的「闕」是什麼意思？",
                options: ["宮殿", "侵損、削減", "缺少", "挖掘"],
                correct: 1
            },
            {
                question: "「若不闕秦，將焉取之」指出了什麼？",
                options: ["秦國弱小", "晉國下一個目標是秦國", "鄭國強大", "三國同盟"],
                correct: 1
            },
            {
                question: "「闕秦以利晉，唯君圖之」是什麼策略？",
                options: ["威脅", "讓秦伯權衡利害、自己決定", "哀求", "諂媚"],
                correct: 1
            },
            {
                question: "燭之武整段說辭的邏輯順序是？",
                options: ["隨意", "從利害→挑撥→警告，層層遞進", "重複", "混亂"],
                correct: 1
            },
            {
                question: "燭之武說服秦伯的核心是？",
                options: ["鄭國強大", "利害分析和挑撥秦晉關係", "哀求", "威脅"],
                correct: 1
            },
            {
                question: "「秦伯說」的「說」讀音和意思是？",
                options: ["shuō，說話", "yuè，同「悅」，高興", "shuì，遊說", "tuō，解脫"],
                correct: 1
            },

            // 第51-60題：秦伯的反應與晉文公的決定
            {
                question: "秦伯被說服後做了什麼？",
                options: ["撤軍", "與鄭國結盟並派兵戍守", "攻打晉國", "觀望"],
                correct: 1
            },
            {
                question: "「與鄭人盟」表示什麼？",
                options: ["結為盟友", "宣戰", "談判", "貿易"],
                correct: 0
            },
            {
                question: "秦伯派了哪些人戍守鄭國？",
                options: ["杞子、逢孫、楊孫", "子犯、先軫", "佚之狐、燭之武", "無人"],
                correct: 0
            },
            {
                question: "「乃還」的「還」是什麼意思？",
                options: ["還給", "返回、撤軍", "還是", "還有"],
                correct: 1
            },
            {
                question: "「子犯」是誰？",
                options: ["鄭國大夫", "晉國大夫（晉文公的舅舅）", "秦國將軍", "楚國使者"],
                correct: 1
            },
            {
                question: "子犯的建議是什麼？",
                options: ["撤軍", "進攻秦軍", "與鄭談和", "等待"],
                correct: 1
            },
            {
                question: "晉文公為什麼不同意攻打秦軍？",
                options: ["害怕", "因為「不仁、不知、不武」", "兵力不足", "想與秦和好"],
                correct: 1
            },
            {
                question: "「微夫人之力不及此」的「微」是什麼意思？",
                options: ["微小", "沒有", "輕微", "微笑"],
                correct: 1
            },
            {
                question: "「夫人」在此指誰？",
                options: ["妻子", "秦穆公", "鄭伯", "燭之武"],
                correct: 1
            },
            {
                question: "「因人之力而敝之」的「敝」是什麼意思？",
                options: ["破舊", "損害", "疲憊", "遮蔽"],
                correct: 1
            },

            // 第61-70題：晉文公的三個理由
            {
                question: "「因人之力而敝之，不仁」是什麼意思？",
                options: ["依靠別人就損害別人，不仁義", "傷害別人不對", "不夠強大", "不夠聰明"],
                correct: 0
            },
            {
                question: "「失其所與，不知」的「知」通什麼字？",
                options: ["之", "智", "志", "制"],
                correct: 1
            },
            {
                question: "「失其所與，不知」是什麼意思？",
                options: ["失去記憶", "失去盟友，不明智", "不知道", "忘記"],
                correct: 1
            },
            {
                question: "「以亂易整，不武」的「武」指什麼？",
                options: ["武器", "武力", "符合軍事原則", "勇武"],
                correct: 2
            },
            {
                question: "「以亂易整」指的是什麼行為？",
                options: ["製造混亂", "用混亂代替整齊（破壞秦晉同盟）", "整理", "改變"],
                correct: 1
            },
            {
                question: "晉文公的三個理由體現了什麼？",
                options: ["懦弱", "深謀遠慮、顧全大局", "害怕", "猶豫不決"],
                correct: 1
            },
            {
                question: "「吾其還也」是什麼句式？",
                options: ["疑問句", "表示商量的語氣", "命令句", "感嘆句"],
                correct: 1
            },
            {
                question: "晉軍最後的選擇是？",
                options: ["進攻", "撤軍", "包圍", "談判"],
                correct: 1
            },
            {
                question: "「亦去之」的「去」是什麼意思？",
                options: ["去除", "離開、撤軍", "去世", "前往"],
                correct: 1
            },
            {
                question: "這次外交事件的結果是？",
                options: ["鄭國滅亡", "鄭國化險為夷", "秦晉開戰", "三國結盟"],
                correct: 1
            },

            // 第71-80題：人物形象分析
            {
                question: "燭之武的形象特點是？",
                options: ["年輕有為", "老而彌堅、智勇雙全", "軟弱無能", "貪生怕死"],
                correct: 1
            },
            {
                question: "燭之武的外交才能體現在？",
                options: ["武力", "善於分析利害、巧妙辭令", "財富", "地位"],
                correct: 1
            },
            {
                question: "燭之武最初推辭說明了什麼？",
                options: ["膽怯", "懷才不遇的牢騷和真實的情感", "自大", "無能"],
                correct: 1
            },
            {
                question: "燭之武最終出使體現了什麼品質？",
                options: ["貪圖富貴", "以國家利益為重的愛國精神", "畏懼權威", "無奈"],
                correct: 1
            },
            {
                question: "鄭伯的形象特點是？",
                options: ["昏庸無能", "知錯能改、善於用人", "專制獨裁", "軟弱無能"],
                correct: 1
            },
            {
                question: "鄭伯說服燭之武時體現了什麼？",
                options: ["威脅", "誠懇的態度和高超的說服技巧", "命令", "哀求"],
                correct: 1
            },
            {
                question: "秦穆公的形象特點是？",
                options: ["愚蠢", "能權衡利害、當機立斷", "殘暴", "軟弱"],
                correct: 1
            },
            {
                question: "晉文公的形象特點是？",
                options: ["衝動", "深謀遠慮、顧全大局", "懦弱", "殘暴"],
                correct: 1
            },
            {
                question: "子犯的建議被拒說明了什麼？",
                options: ["子犯無能", "晉文公的戰略眼光高於子犯", "晉文公懦弱", "秦國強大"],
                correct: 1
            },
            {
                question: "這篇文章主要刻畫的人物是？",
                options: ["鄭伯", "燭之武", "秦伯", "晉文公"],
                correct: 1
            },

            // 第81-90題：寫作技巧與藝術特色
            {
                question: "文章的敘事特點是？",
                options: ["冗長拖沓", "簡潔明快、重點突出", "平鋪直敘", "倒敘"],
                correct: 1
            },
            {
                question: "文章的重點是什麼？",
                options: ["戰爭場面", "燭之武的遊說辭令", "歷史背景", "人物外貌"],
                correct: 1
            },
            {
                question: "燭之武的說辭採用了什麼論證方法？",
                options: ["只有舉例", "利害分析、對比、假設等多種方法", "只有引用", "沒有論證"],
                correct: 1
            },
            {
                question: "文章的語言特點是？",
                options: ["華麗辭藻", "精煉、邏輯嚴密", "口語化", "詩意"],
                correct: 1
            },
            {
                question: "文章通過什麼展現人物性格？",
                options: ["外貌描寫", "語言和行動", "心理描寫", "環境描寫"],
                correct: 1
            },
            {
                question: "文章的結構特點是？",
                options: ["散亂", "起因→發展→高潮→結局，結構完整", "只有開頭", "沒有結尾"],
                correct: 1
            },
            {
                question: "文章的高潮部分是？",
                options: ["圍鄭", "燭之武說秦伯", "晉軍撤退", "鄭伯說燭之武"],
                correct: 1
            },
            {
                question: "文章運用了什麼對比手法？",
                options: ["沒有對比", "燭之武出使前後、秦晉態度前後的對比", "只有人物對比", "環境對比"],
                correct: 1
            },
            {
                question: "文章的詳略處理是？",
                options: ["平均用力", "詳寫遊說，略寫其他", "全部詳寫", "全部略寫"],
                correct: 1
            },
            {
                question: "這篇文章的文學價值在於？",
                options: ["篇幅長", "展現了高超的外交辭令藝術", "純歷史記錄", "描寫戰爭"],
                correct: 1
            },

            // 第91-100題：歷史背景與深層意義
            {
                question: "這個故事發生在什麼時期？",
                options: ["西周", "春秋時期", "戰國時期", "秦朝"],
                correct: 1
            },
            {
                question: "當時的國際形勢特點是？",
                options: ["統一", "諸侯爭霸、外交頻繁", "和平", "閉關鎖國"],
                correct: 1
            },
            {
                question: "晉文公是春秋五霸之一，稱霸的基礎是？",
                options: ["武力", "武力與外交並重", "財富", "運氣"],
                correct: 1
            },
            {
                question: "這個故事對後世外交的啟示是？",
                options: ["武力最重要", "外交辭令和策略的重要性", "金錢最重要", "運氣最重要"],
                correct: 1
            },
            {
                question: "「不戰而屈人之兵」最接近文中哪個情節？",
                options: ["圍鄭", "燭之武退秦師", "晉軍撤退", "秦晉結盟"],
                correct: 1
            },
            {
                question: "文章體現的外交原則是？",
                options: ["強權", "利益、信義與智慧", "欺騙", "暴力"],
                correct: 1
            },
            {
                question: "燭之武成功的關鍵是？",
                options: ["運氣", "準確把握各國利益關係", "哀求", "賄賂"],
                correct: 1
            },
            {
                question: "這篇文章的現實意義是？",
                options: ["沒有意義", "展現談判藝術和外交智慧", "過時了", "只有歷史價值"],
                correct: 1
            },
            {
                question: "《左傳》是一部什麼性質的著作？",
                options: ["小說", "編年體史書", "詩歌", "戲劇"],
                correct: 1
            },
            {
                question: "這篇文章最大的價值在於？",
                options: ["記錄戰爭", "展現外交智慧和語言藝術", "歌頌英雄", "批評敵人"],
                correct: 1
            }
        ];

        let currentQuestion = 0;
        let userAnswers = [];
        let score = 0;

        function startTest() {
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('articleText').style.display = 'none';
            document.getElementById('progressBar').style.display = 'block';
            showQuestion(0);
        }

        function showQuestion(index) {
            const container = document.getElementById('questionContainer');
            const question = questions[index];

            container.className = 'question-container active';
            container.innerHTML = `
                <div class="question-header">
                    <span class="question-number">第 ${index + 1} 題 / 共 100 題</span>
                    <span>已完成: ${userAnswers.length}/100</span>
                </div>
                <div class="question-text">${question.question}</div>
                <div class="options">
                    ${question.options.map((option, i) => `
                        <div class="option" onclick="selectOption(${i})" data-index="${i}">
                            ${String.fromCharCode(65 + i)}. ${option}
                        </div>
                    `).join('')}
                </div>
                <div class="feedback" id="feedback"></div>
                <div class="navigation">
                    <button class="btn btn-secondary" onclick="previousQuestion()" ${index === 0 ? 'disabled' : ''}>
                        上一題
                    </button>
                    <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" disabled>
                        ${index === questions.length - 1 ? '完成測驗' : '下一題'}
                    </button>
                </div>
            `;

            if (userAnswers[index] !== undefined) {
                const options = container.querySelectorAll('.option');
                options[userAnswers[index]].classList.add('selected');
                document.getElementById('nextBtn').disabled = false;
            }

            updateProgress();
        }

        function selectOption(optionIndex) {
            const options = document.querySelectorAll('.option');
            const feedback = document.getElementById('feedback');
            const question = questions[currentQuestion];

            options.forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
            });

            options[optionIndex].classList.add('selected');
            userAnswers[currentQuestion] = optionIndex;

            if (optionIndex === question.correct) {
                feedback.className = 'feedback show correct';
                feedback.textContent = '✓ 回答正確！';
                options[optionIndex].classList.add('correct');
            } else {
                feedback.className = 'feedback show incorrect';
                feedback.textContent = `✗ 回答錯誤。正確答案是：${String.fromCharCode(65 + question.correct)}. ${question.options[question.correct]}`;
                options[optionIndex].classList.add('incorrect');
                options[question.correct].classList.add('correct');
            }

            document.getElementById('nextBtn').disabled = false;
        }

        function nextQuestion() {
            if (userAnswers[currentQuestion] === undefined) {
                alert('請選擇一個答案');
                return;
            }

            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                showQuestion(currentQuestion);
            } else {
                showResults();
            }
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion(currentQuestion);
            }
        }

        function updateProgress() {
            const progress = ((currentQuestion + 1) / questions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function showResults() {
            score = 0;
            for (let i = 0; i < questions.length; i++) {
                if (userAnswers[i] === questions[i].correct) {
                    score++;
                }
            }

            const percentage = (score / questions.length * 100).toFixed(1);

            let message = '';
            if (percentage >= 90) {
                message = '優秀！您對《燭之武退秦師》的理解非常深入！';
            } else if (percentage >= 80) {
                message = '良好！您對《燭之武退秦師》有很好的理解！';
            } else if (percentage >= 70) {
                message = '不錯！繼續加油！';
            } else if (percentage >= 60) {
                message = '及格了！還有提升空間！';
            } else {
                message = '需要加強對《燭之武退秦師》的學習哦！';
            }

            document.getElementById('questionContainer').classList.remove('active');
            const resultContainer = document.getElementById('resultContainer');
            resultContainer.classList.add('active');

            document.getElementById('scoreDisplay').textContent = `${score}/100`;
            document.getElementById('scoreMessage').textContent = message;

            const details = document.getElementById('resultDetails');
            details.innerHTML = `
                <h3>測驗統計</h3>
                <div class="detail-item">
                    <span>正確率：</span>
                    <span><strong>${percentage}%</strong></span>
                </div>
                <div class="detail-item">
                    <span>答對題數：</span>
                    <span><strong>${score} 題</strong></span>
                </div>
                <div class="detail-item">
                    <span>答錯題數：</span>
                    <span><strong>${questions.length - score} 題</strong></span>
                </div>
            `;

            updateProgress();
        }

        function restartTest() {
            currentQuestion = 0;
            userAnswers = [];
            score = 0;
            document.getElementById('resultContainer').classList.remove('active');
            document.getElementById('startScreen').style.display = 'block';
            document.getElementById('articleText').style.display = 'block';
            document.getElementById('progressBar').style.display = 'none';
            document.getElementById('progressFill').style.width = '0%';
        }
    </script>
</body>
</html>